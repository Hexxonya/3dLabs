<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>3D 1-5 labs</title>
<script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-extras.ocean@%5E3.5.x/dist/aframe-extras.ocean.min.js"></script>
    <script src="https://unpkg.com/aframe-event-set-component@3.0.3/dist/aframe-event-set-component.min.js"></script>
    <script src="https://unpkg.com/aframe-particle-system-component@1.0.9/dist/aframe-particle-system-component.min.js"></script>
</head>
<body>
    
<a-scene >

    <a-entity position="-4 0 -2" rotation="0 -90 0">
        <a-camera id="camera">
          <a-cursor color="#9D0B28"></a-cursor>
        </a-camera>
      </a-entity>

    <a-assets>
        <img id="wall" src="./textures/WallTexture.png">
        <img id="wallnormal" src="./textures/WallTextureNormal.png">
        <img id="roof" src="./textures/woodroof.png">
        <img id="roofnormal" src="./textures/woodroofnormal.png">
        <img id="grass" src="./textures/GrassAl.png">
        <img id="grassNormal" src="./textures/GrassNormal.png">
        <img id="window" src="./textures/TexturesCom_WoodPlanksOld0179_2_M.jpg">
        <img id="door" src="./textures/TexturesCom_DoorsWoodSingleOld0226_M.jpg">
        <img id="sky" src="./textures/olympic-np-hoh-rainforest-spherical-360x360.jpg">
        <img id="woodleaf" src="./textures/conifer080.png">
        <img id="tree" src="./textures/tree.png">
        <img id="bgtree" src="./textures/Bgtree.png">

        
    <a-asset-item id="tigrmtl" src="./model/tigrtexture.mtl"></a-asset-item>
    <a-asset-item id="tigr" src="./model/tigr.obj"></a-asset-item>


    <a-asset-item id="fox" src="./model/fox.OBJ"></a-asset-item>

    <audio id="hoversound" src="./hover.mp3"></audio>
    <audio id="aftersound" src="./aftersound.mp3"></audio>
    <audio id="background" src="./background.mp3" autoplay volume="0.5"></audio>
    <audio id="wind" src="./wind.wav" autoplay loop="true" volume="0.5"></audio>


      <!-- userMixin -->

    <a-mixin id="column" geometry="primitive: box; depth: .75; height: 1.2; width: .75" material="color: #ccc" position="0 .6 0"></a-mixin>
    <a-mixin id="column-bottom" geometry="primitive: box; depth: 1; height: .1; width: 1;" material="color: #ccc" position="0 .1 0"></a-mixin>
    <a-mixin id="column-light" light="type: point; intensity: 0.5; distance: 5;" position="0 1.5 0"></a-mixin>
    <a-mixin id="torus-knot" geometry="primitive: torusKnot; p: 3; q: 7; radius: .25; segmentsRadial: 10; radiusTubular: .07; segmentsTubular: 32"> </a-mixin>
    <a-mixin id="object-on-column" position="0 1.2 0"></a-mixin>

    <a-mixin id="spin" animation__spin="property: object3D.rotation.y; to: 360; loop: true; easing: linear; dur: 10000"></a-mixin>
    <a-mixin id="color" material="color: #FFFFC3"></a-mixin>

    </a-assets>


<!-- lawn -->
<a-plane position="0 0 -4" rotation="-90 0 0" width="75" height="75" color="#fff" src="#grass" repeat="20 20" normal-scale="2 2" normal-map="#grassNormal" normal-texture-repeat="20 20" shadow="receive: true"></a-plane>

<!-- walls -->
<a-box position="0 0.5 -4" rotation="0 0 0" color="#fff" width="3" height="1.6" depth="2" src="#wall" normal-map="#wallnormal" normal-scale="1.5 1.5" repeat="3 1" normal-texture-repeat="3 1" shadow="cast: true"></a-box>
<a-box position="-1 0.5 -4" rotation="0 90 0" color="#fff" width="1" height="1.6" depth="2" src="#wall" normal-map="#wallnormal" normal-scale="1.5 1.5" shadow="cast: true"></a-box>

<!-- roof -->
<a-box position="-1.6 1.5 -4.3" rotation="0 90 45" color="#ccc" width="0.1" height="0.95" depth="1.1" src="#roof" normal-map="#roofnormal" normal-scale="1.5 1.5" ></a-box>
<a-box position="-1.6 1.5 -3.7" rotation="0 90 -45" color="#ccc" width="0.1" height="0.92" depth="1.1" src="#roof" normal-map="#roofnormal" normal-scale="1.5 1.5" ></a-box>

<a-box position="0 1.75 -4.5" rotation="0 90 45" color="#ccc" width="0.1" height="1.6" depth="3.4" src="#roof" normal-map="#roofnormal" normal-scale="1.5 1.5" repeat="2 1" normal-texture-repeat="2 1" ></a-box>
<a-box position="0 1.75 -3.48" rotation="0 90 -45" color="#ccc" width="0.1" height="1.6" depth="3.4" src="#roof" normal-map="#roofnormal" normal-scale="1.5 1.5" repeat="2 1" normal-texture-repeat="2 1"></a-box>

<a-triangle position="-2 1.25 -4" rotation="0 -90 0" color="#fff" vertex-c="0.5 0.05 0" vertex-b="-0.5 0.05 0" src="#wall" normal-map="#wallnormal" normal-scale="1.5 1.5" repeat="1 0.5" normal-texture-repeat="1 0.5" shadow="cast: true"></a-triangle>

<a-triangle position="1.5 1.75 -4" rotation="0 90 0" color="#fff" vertex-c="1 -0.45 0" vertex-b="-1 -0.45 0" src="#wall" normal-map="#wallnormal" normal-scale="1.5 1.5" repeat="2 1" normal-texture-repeat="2 1" shadow="cast: true"></a-triangle>
<a-triangle position="-1.5 1.75 -4" rotation="0 -90 0" color="#fff" vertex-c="1 -0.45 0" vertex-b="-1 -0.45 0" src="#wall" normal-map="#wallnormal" normal-scale="1.5 1.5" repeat="2 1" normal-texture-repeat="2 1" shadow="cast: true"></a-triangle>

<!-- door -->
<a-box position="-2 0.52 -4" rotation="0 90 0" color="#ccc" width="0.6" height="1" src="#door" depth="0.1"></a-box>
<a-box position="-2 0 -4" rotation="0 90 0" color="#9a9a9a" width="0.7" height="0.1" depth="0.7" src="#wall" normal-map="#wallnormal" normal-scale="1.5 1.5"></a-box>

<!-- windows -->
<a-box position="1 0.65 -3.08" rotation="0 0 0" color="#ccc" width="0.35" height="0.6" depth="0.2" src="#window"></a-box>
<a-box position="0.62 0.65 -3.08" rotation="0 0 0" color="#ccc" width="0.35" height="0.6" depth="0.2" src="#window"></a-box>

<a-box position="-1 0.65 -3.08" rotation="0 0 0" color="#ccc" width="0.35" height="0.6" depth="0.2" src="#window"></a-box>
<a-box position="-0.62 0.65 -3.08" rotation="0 0 0" color="#ccc" width="0.35" height="0.6" depth="0.2" src="#window"></a-box>

<!-- light -->
<a-entity light="type: ambient; color: #c3cad6"></a-entity>
<a-entity light="type: directional; color: #FFF; intensity: 0.6; castShadow:true;" position="1 1 1" ></a-entity>

<!-- animation -->
<a-entity position="-4 0.2 -4" rotation="0 0 0" animation="property: rotation; to: 0 360 0; loop: true; dur: 3000">
    <a-sphere position="0 0.2 -0.2" color="#9D0B28" radius="0.05" shadow="cast: true"></a-sphere>
</a-entity>

<a-entity particle-system="preset: snow; particleCount: 10000" position="0 0 -10" ></a-entity>


<!-- bassein -->
<a-torus position="0 0.25 1" rotation="90 0 0" color="#75c1ff" arc="360" radius="1.5" radius-tubular="0.15" shadow="cast: true"></a-torus>
<a-circle position="0 0.01 1" rotation="-90 0 0" color="#75c1ff" radius="1.5"></a-circle>
<a-ocean position="0 0.25 1" density="4" color="#6897BB" depth="3" width="2"></a-ocean>

<a-sound src="./basein.wav" autoplay="true" position="0 0.25 1" loop="true" sound="maxDistance: 5; distanceModel: linear; volume:0.5;"></a-sound>

<!-- next -->
<a-sphere position="8 -2 -20" color="#ccc" radius="4" src="#grass" repeat="6 6" normal-map="#grassNormal" normal-scale="3 3" ambient-occlusion-map="#grassAO" ambient-occlusion-texture-repeat="6 6" normal-texture-repeat="6 6"></a-sphere>
<a-sphere position="12 -1 -18" color="#ccc" radius="4" src="#grass" repeat="6 6" normal-map="#grassNormal" normal-scale="3 3" ambient-occlusion-map="#grassAO" ambient-occlusion-texture-repeat="6 6" normal-texture-repeat="6 6"></a-sphere>
<a-sphere position="16 -1.5 -16" color="#ccc" radius="4" src="#grass" repeat="6 6" normal-map="#grassNormal" normal-scale="3 3" ambient-occlusion-map="#grassAO" ambient-occlusion-texture-repeat="6 6" normal-texture-repeat="6 6"></a-sphere>

<!-- sky -->
<a-sky rotation="0 135 0" src="#sky"></a-sky>
<a-sphere radius="40" color="#ccc" material=" transparent:true; side:double; opacity:0.15"></a-sphere>

<!-- object -->

<a-entity position="-4 0 -4">
  <a-box position="0 0.3 0" rotation="0 0 0" color="#ccc"  width="0.8" height="0.05" depth="1" src="#wall" normal-map="#wallnormal" normal-scale="1.5 1.5"  shadow="cast: true"></a-box>
  <a-box position="-0.2 0 -0.3" rotation="0 0 0" color="#ccc"  width="0.05" height="0.6" depth="0.05" src="#wall" normal-map="#wallnormal" normal-scale="1.5 1.5" repeat="3 1" normal-texture-repeat="3 1" shadow="cast: true"></a-box>
  <a-box position="0.2 0 0.3" rotation="0 0 0" color="#ccc"  width="0.05" height="0.6" depth="0.05" src="#wall" normal-map="#wallnormal" normal-scale="1.5 1.5" repeat="3 1" normal-texture-repeat="3 1" shadow="cast: true"></a-box>
  <a-box position="-0.2 0 0.3" rotation="0 0 0" color="#ccc"  width="0.05" height="0.6" depth="0.05" src="#wall" normal-map="#wallnormal" normal-scale="1.5 1.5" repeat="3 1" normal-texture-repeat="3 1" shadow="cast: true"></a-box>
  <a-box position="0.2 0 -0.3" rotation="0 0 0" color="#ccc"  width="0.05" height="0.6" depth="0.05" src="#wall" normal-map="#wallnormal" normal-scale="1.5 1.5" repeat="3 1" normal-texture-repeat="3 1" shadow="cast: true"></a-box>
</a-entity>



<!-- user object -->

<a-entity position="-4 -0.1 -8">
  <a-entity mixin="column">
  <a-entity mixin="column-light"></a-entity>
  <a-entity mixin="object-on-column color torus-knot spin"></a-entity>
  </a-entity>
  <a-entity mixin="column-bottom"></a-entity>
  </a-entity>

<!-- overlap -->

<a-entity position="-0 1 4">
<a-text value="HOVER" color="black" scale="2 2 2" position="1 1 0" rotation="0 180 0"></a-text>
<a-box position="0 0 0" rotation="0 0 0" color="white"
           event-set__enter="_event: mouseenter; color: orange"
           event-set__leave="_event: mouseleave; color: white"></a-box>
</a-entity>

<a-entity position="-8 1 4">
    <a-text value="Distance Sound on/off event" color="black" scale="2 2 2" position="2 1 0" rotation="0 180 0"></a-text>
    <a-box hover-sound  color="black" sound="src: #hoversound; maxDistance: 10; distanceModel: linear; volume:1;"></a-box>
</a-entity>

<a-entity position="-4 1 4">
        <a-text value="Touch event" color="black" scale="2 2 2" position="1 1 0" rotation="0 180 0"></a-text>
        <a-sphere position="0 0 0" radius="0.8" color="#EF2D5E"
        event-set__down="_event: mousedown; scale: 1.2 1.2 1.2; color: blue;"
        event-set__up="_event: mouseup; scale: 1 1 1; color: #EF2D5E;"
        event-set__leave="_event: mouseleave; scale: 1 1 1; color: #EF2D5E;" ></a-sphere>
        </a-entity>

<a-entity position="3 1 0">
            <a-text value="Sound end event" color="black" scale="2 2 2" position="0 1 -1.5" rotation="0 270 0"></a-text>
            <a-box sound-end-event color="tomato"
            sound="src: #aftersound; maxDistance: 10; distanceModel: linear; volume:0.5; autoplay:true;"></a-box>
        </a-entity>

<!-- model -->

<a-entity shadow="cast: true" animation="property: rotation; to: 0 360 0; dur: 4000; easing: linear; loop: true" position="-3.8 0.6 -3.5" scale="0.05 0.05 0.05">
<a-obj-model shadow="cast: true" src="#fox"></a-obj-model>
</a-entity>

<a-obj-model shadow="cast: true"  rotation="0 -35 0" scale="1 1 1" position="-3 0.35 -3" src="#tigr" mtl="#tigrmtl"></a-obj-model>

</a-scene>

<script>

AFRAME.registerComponent('hover-sound', {
    events: {
      mouseenter: function () {
        this.el.components.sound.playSound();
        this.el.setAttribute('material', 'color', 'yellow');
      },
      mouseleave: function () {
        this.el.components.sound.pauseSound();
        this.el.setAttribute('material', 'color', 'black');
      }
    }
  });


AFRAME.registerComponent('sound-end-event', {
    init: function () {
      this.el.addEventListener('sound-ended', () => {
        this.el.setAttribute('color', 'blue');
      });
    },
  }); 
</script>

</body>
</html>